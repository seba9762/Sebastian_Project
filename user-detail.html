<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Details - German Vocabulary Learning System</title>
    <link rel="stylesheet" href="assets/css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
</head>
<body>
    <div class="dashboard">
        <header>
            <h1>üìä User Analytics Dashboard</h1>
            <p class="subtitle" id="userNameSubtitle">Loading user information...</p>
            <div class="button-group">
                <a href="dashboard.html" class="btn">‚Üê Back to Dashboard</a>
                <button class="btn btn-secondary" id="refreshBtn">üîÑ Refresh</button>
                <button class="btn btn-secondary" id="printBtn">üñ®Ô∏è Print</button>
            </div>
        </header>

        <div id="alertArea"></div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Words Learned</div>
                <div class="stat-value" id="statWordsLearned">-</div>
                <div class="stat-trend">üìö Total vocabulary</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Overall Accuracy</div>
                <div class="stat-value" id="statAccuracy">-</div>
                <div class="stat-trend">‚úÖ Success rate</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Study Streak</div>
                <div class="stat-value" id="statStreak">-</div>
                <div class="stat-trend">üî• Consecutive days</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Mastery Level</div>
                <div class="stat-value" id="statMastery">-</div>
                <div class="stat-trend">üéØ Overall proficiency</div>
            </div>
        </div>

        <div class="chart-grid">
            <div class="chart-card">
                <h3 class="chart-title">üìà Learning Progress Timeline</h3>
                <canvas id="timelineChart"></canvas>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">üéì Mastery Distribution</h3>
                <canvas id="masteryChart"></canvas>
            </div>
        </div>

        <div class="section">
            <h3 class="section-title">üî• Learning Patterns Heatmap</h3>
            <canvas id="heatmapChart"></canvas>
        </div>

        <div class="section">
            <h3 class="section-title">‚ö†Ô∏è Mistake Analysis</h3>
            <div class="chart-grid">
                <div class="chart-card">
                    <h3 class="chart-title">By Type</h3>
                    <canvas id="mistakeTypeChart"></canvas>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">By Category</h3>
                    <canvas id="mistakeCategoryChart"></canvas>
                </div>
            </div>
            
            <div class="chart-grid">
                <div class="chart-card">
                    <h3 class="chart-title">By Severity</h3>
                    <canvas id="mistakeSeverityChart"></canvas>
                </div>
                
                <div class="chart-card">
                    <h3 class="chart-title">Trends Over Time</h3>
                    <canvas id="mistakeTrendsChart"></canvas>
                </div>
            </div>
        </div>

        <div class="table-card">
            <h3 class="chart-title">üìñ Challenging Words</h3>
            <table>
                <thead>
                    <tr>
                        <th>Word</th>
                        <th>Translation</th>
                        <th>Attempts</th>
                        <th>Success Rate</th>
                        <th>Difficulty</th>
                        <th>Last Practiced</th>
                    </tr>
                </thead>
                <tbody id="challengingWordsBody">
                    <tr>
                        <td colspan="6">
                            <div class="loading">
                                <span class="spinner"></span>
                                Loading challenging words...
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="table-card">
            <h3 class="chart-title">üìã Recent Activity</h3>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Activity Type</th>
                        <th>Details</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody id="recentActivityBody">
                    <tr>
                        <td colspan="4">
                            <div class="loading">
                                <span class="spinner"></span>
                                Loading recent activity...
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h3 class="section-title">üìö Chapter Progress</h3>
            <div id="chapterProgressContainer">
                <div class="loading">
                    <span class="spinner"></span>
                    Loading chapter progress...
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        const SUPABASE_URL = 'YOUR_SUPABASE_URL';
        const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY';

        import { initUserDetail } from './assets/js/user-detail.js';
        
        window.addEventListener('load', () => {
            initUserDetail(SUPABASE_URL, SUPABASE_ANON_KEY);
        });
    </script>
</body>
</html>
